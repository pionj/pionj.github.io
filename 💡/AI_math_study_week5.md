---
title: "AI_math_study_week5"
description: "AI_math_study_week5.md | (2025 June 15 Sunday)"
date: 2025-06-15T23:04:19+09:00
lastmod: 2025-06-15T23:04:19+09:00
categories: 
- AI
tags: 
- 
series:
- ai math study
draft: false
private: false
---

# AI 수학 스터디 (5주차)

## TOC
- [AI 수학 스터디 (5주차)](#ai-수학-스터디-5주차)
  - [Prologue](#prologue)
  - [합성곱(Convolution)과 교차 상관(Cross-Correlation)](#h2-1)
  - [시스템 설계 관점에서의 합성곱](#h2-2)
    - [선형 및 시점/병진 불변 시스템을 위한 합성곱과 임펄스 응답](#h2-2-1)
  - [1차원 및 2차원 이산 신호와 합성곱](#h2-3)
    - [1차원 이산 신호](#h2-3-1)
    - [2차원 이산 신호](#h2-3-2)
  - [이미지 필터링 (Filtering Images)](#h2-4)
  - [특징 맵 (Feature Maps)](#h2-5)
  - [선형 대수 표기법](#h2-6)
    - [1차원 경우: 퇴플리츠 행렬(Toeplitz Matrix) 곱셈](#h2-6-1)
    - [2차원 경우: 이중 블록 순환 행렬(Doubly Block Circulant Matrix) 곱셈](#h2-6-2)
  - [풀링 (Pooling)](#h2-7)
  - [이미지 분류를 위한 합성곱 신경망 (CNN)](#h2-8)
  - [Summary](#summary)
  - [Epilogue](#epilogue)

## Prologue
지난 4장에서는 일반적인 신경망의 최적화 과정, 특히 완전 연결 계층을 중심으로 살펴보았다. 이번 5장, "Convolutional Neural Networks and Computer Vision"에서는 신경망 아키텍처에 **합성곱(Convolution)**이라는 특별한 연산을 도입하여, 특히 이미지와 같은 **그리드 형태의 데이터(grid-like data)** 를 처리하는 데 혁명을 일으킨 **합성곱 신경망(Convolutional Neural Networks, CNNs)** 에 대해 알아본다. 저자는 _"그들은 볼 수 있다.(They. Can. See.)"_ 라는 간결한 문장으로 CNN의 강력한 시각적 인지 능력을 암시하며 장을 시작한다. 컴퓨터 비전뿐만 아니라 자연어 처리 분야에서도 응용되는 CNN의 핵심 원리를 파헤쳐 보자.

## 합성곱(Convolution)과 교차 상관(Cross-Correlation) [🔝](#toc) <a id="h2-1"></a>
합성곱과 교차 상관은 약간 다른 연산이지만, 머신러닝 용어에서는 종종 혼용된다. 핵심적인 차이는 필터(커널)를 뒤집느냐(flip) 마느냐에 있다.
*   **합성곱:** 필터를 뒤집은 후, 입력 신호 위를 슬라이딩하며 연산한다. 수학적으로 교환 법칙(commutative)이 성립하는 장점이 있다 (이론적 증명에 유리).
*   **교차 상관:** 필터를 뒤집지 않고, 입력 신호 위를 슬라이딩하며 연산한다.
신경망 관점에서는 필터를 학습 과정에서 배우기 때문에 필터를 뒤집는 것은 실질적으로 중요하지 않다. 또한, 다채널 입력이나 배치 처리 시 교환 법칙이 보장되지 않는 경우가 많으므로, 대부분의 머신러닝 라이브러리는 **교차 상관을 구현하고 이를 합성곱이라고 부른다.** 이 책에서도 이 관례를 따른다.

두 실수 값 함수 `k`(필터)와 `f`(입력 신호) 사이의 합성곱 연산(`k ☆ f`)과 교차 상관 연산(`k * f`)은 적분 또는 합산 형태로 정의된다. (책 164페이지 수식 참고)
중요한 것은 이 연산이 "무한한 영역에 대한 합산/적분"을 포함한다는 점이며, 이는 입력 함수 `f`와 필터 `k`가 특정 조건(예: 유한한 지지(compact support)를 갖거나 충분히 빠르게 감쇠)을 만족해야 계산이 의미를 갖는다는 것을 시사한다.

## 시스템 설계 관점에서의 합성곱 [🔝](#toc) <a id="h2-2"></a>
우리는 시스템(예: 건물 HVAC, 자동차 크루즈 컨트롤 등)에 둘러싸여 있으며, 이러한 시스템은 입력 신호를 처리하여 출력 신호를 생성한다. 만약 시스템이 두 가지 특별한 제약 조건, 즉 **선형성(linearity)**과 **시점/병진 불변성(time/translation invariance)**을 만족한다면, 합성곱 연산이 자연스럽게 등장한다.
*   **선형성:** 입력 신호의 스케일링(증폭/감소)은 출력 신호의 동일한 스케일링으로 이어지고, 두 입력 신호의 중첩은 각 신호에 대한 출력의 중첩으로 이어진다.
*   **시점/병진 불변성:** 입력 신호의 지연(시간)/이동(공간)은 출력 신호의 동일한 지연/이동으로 이어진다.

이 두 속성이 결합되면, 시스템의 출력을 매우 간단하게 분석할 수 있게 된다. 시스템의 **임펄스 응답(impulse response)**, 즉 매우 짧은 단일 입력 신호에 대한 시스템의 출력만 알면, 임의의 입력 신호에 대한 시스템의 출력은 **입력 신호와 임펄스 응답의 합성곱**으로 구할 수 있다.

### 선형 및 시점/병진 불변 시스템을 위한 합성곱과 임펄스 응답 [🔝](#toc) <a id="h2-2-1"></a>
임의의 이산 신호 `x(n)`은 다양한 진폭을 가진 단위 임펄스 신호들의 중첩으로 표현될 수 있다. (책 170페이지 수식 참고)
만약 시스템 `H`가 선형성과 병진 불변성을 만족한다면, 입력 신호 `x(n)`에 대한 시스템의 응답 `y(n)`은 다음과 같이 유도된다:
`y(n) = H(x(n)) = (x ☆ h)(n)`
여기서 `h(n)`은 시스템 `H`의 임펄스 응답이다. 즉, 선형 및 병진 불변 시스템은 그것의 임펄스 응답에 의해 완벽하게 기술된다.
이는 필터 `h(n)`을 신중하게 설계함으로써 입력 신호 `x(n)`으로부터 원하는 특징을 추출하거나 특정 특성을 가진 출력 신호 `y(n)`을 생성할 수 있음을 의미한다. CNN에서는 각 합성곱 계층에서 서로 다른 특징들이 추출(매핑)된다.

## 1차원 및 2차원 이산 신호와 합성곱 [🔝](#toc) <a id="h2-3"></a>

### 1차원 이산 신호 [🔝](#toc) <a id="h2-3-1"></a>
입력 신호 `x(n)` (예: `[x₀, x₁, x₂, x₃, x₄]`)과 필터(커널) `k(n)` (예: `[k₀, k₁, k₂]`)이 주어졌을 때, 합성곱(여기서는 교차 상관) 결과 `z(n) = (k * x)(n)`은 필터 `k(n)`을 신호 `x(n)` 위에서 오른쪽에서 왼쪽으로 슬라이딩하면서 각 위치에서 대응하는 요소끼리 곱한 후 모두 더하여 계산한다. (책 171-172페이지 예시 참고)
이 연산은 필터가 신호의 특정 패턴과 얼마나 유사한지를 측정하는 방법으로 볼 수 있으며, 출력 신호는 필터와 신호가 일치하는 지점에서 큰 값을 갖는다. 또한, 출력 신호의 각 항목은 입력 신호 항목들의 가중 평균으로 볼 수도 있다.

### 2차원 이산 신호 [🔝](#toc) <a id="h2-3-2"></a>
2차원 합성곱(교차 상관) 연산 `(K * A)(m,n)`은 2차원 필터(커널) `K`를 2차원 입력 신호(이미지) `A` 위에서 슬라이딩하면서 계산한다. 특정 위치 `(m,n)`에서의 출력값은 커널 `K`의 중심을 `A`의 `(m,n)` 위치에 놓고, 겹치는 부분의 대응하는 픽셀 값들을 곱한 후 모두 더하여 얻는다. (책 172-173페이지 예시 참고)
일반적으로 필터링된 이미지 `Z`는 원본 이미지 `A`보다 크기가 작아진다. 원본과 동일한 크기의 출력을 얻기 위해서는 입력 이미지의 경계에 0을 채우는 **제로 패딩(zero padding)**을 사용한다. (다른 패딩 방법: 반사(reflection), 반복(wraparound))

## 이미지 필터링 (Filtering Images) [🔝](#toc) <a id="h2-4"></a>
동일한 이미지에 다양한 커널을 사용하여 합성곱 연산을 수행하면 이미지의 다양한 특징들을 추출할 수 있다. (책 그림 5-1 참고)
*   **엣지 검출(Edge detection) 커널:** 이미지의 경계선을 강조한다. 예를 들어, 중심 값은 크고 주변 값은 작은 음수인 커널은 픽셀 값의 급격한 변화(엣지)가 있는 곳에서 큰 값을 출력한다.
*   **샤프닝(Sharpen) 커널:** 이미지의 디테일을 선명하게 한다.
*   **박스 블러(Box blur) / 가우시안 블러(Gaussian blur) 커널:** 이미지를 부드럽게 만들고 노이즈를 제거한다. 주변 픽셀들의 평균값을 취하는 효과가 있다.
**가버 필터(Gabor filters)**는 특정 방향과 주파수의 패턴/질감 특징을 검출하도록 설계된 필터로, 인간의 시각 시스템에서 발견되는 필터와 유사하게 작동한다. (책 그림 5-2 참고)

## 특징 맵 (Feature Maps) [🔝](#toc) <a id="h2-5"></a>
CNN은 완전 연결 네트워크와 마찬가지로 손실 함수를 최적화하여 데이터로부터 커널(필터)을 학습한다. 합성곱 계층(비선형 활성화 함수 포함)의 출력을 **특징 맵(feature map)**이라고 하며, 학습된 커널은 **특징 검출기(feature detectors)** 역할을 한다.
일반적으로 네트워크의 초기 계층(입력에 가까운 계층)은 엣지와 같은 저수준 특징을 학습하고, 후기 계층은 형태와 같은 고수준 특징을 학습한다. 특징 맵을 시각화하면 훈련된 네트워크가 각 합성곱 계층에서 무엇을 감지하는지 직접 관찰할 수 있다. (책 그림 5-3 참고)

## 선형 대수 표기법 [🔝](#toc) <a id="h2-6"></a>
CNN 내부의 가장 기본적인 연산은 합성곱이다. 합성곱은 선형 연산이므로 행렬 곱셈으로 효율적으로 표현할 수 있다. 훈련 함수-손실 함수-최적화의 수학적 구조는 이전 장들과 동일하다.
완전 연결 네트워크와의 차이점은 선형 결합이 이제 필터와 관련된 가중치로 발생한다는 것이다 (모든 가중치가 서로 다를 필요는 없음). 또한 필터 크기는 일반적으로 입력 신호보다 훨씬 작으므로, 합성곱을 행렬로 표현하면 대부분의 가중치가 0인 **희소 행렬(sparse matrix)**이 된다. 이는 저장 공간과 계산 시간을 크게 절약하면서 중요한 지역적 상호작용을 포착할 수 있게 한다.
네트워크의 출력 계층 근처에는 완전 연결 계층이 사용되기도 하는데, 이는 추출된 중요한 특징들을 결합하여 최종 예측을 만드는 역할을 한다.

### 1차원 경우: 퇴플리츠 행렬(Toeplitz Matrix) 곱셈 [🔝](#toc) <a id="h2-6-1"></a>
1차원 합성곱 연산은 입력 신호 벡터를 **퇴플리츠 행렬(Toeplitz matrix)**이라는 특별한 종류의 행렬과 곱하는 것으로 표현할 수 있다. 퇴플리츠 행렬은 각 대각선 라인의 요소들이 모두 같은 값을 가지는 행렬이다. (책 182페이지 참고)

### 2차원 경우: 이중 블록 순환 행렬(Doubly Block Circulant Matrix) 곱셈 [🔝](#toc) <a id="h2-6-2"></a>
2차원 합성곱 연산은 이미지를 필터링하는 것으로, 퇴플리츠 행렬 대신 각 행이 특정 벡터의 순환 이동(circular shift)인 **이중 블록 순환 행렬(doubly block circulant matrix)**과의 곱셈으로 표현된다. 딥러닝에서는 이러한 행렬의 가중치(항목)들을 학습한다.

## 풀링 (Pooling) [🔝](#toc) <a id="h2-7"></a>
거의 모든 CNN에서 입력이 합성곱을 통해 필터링되고 비선형 활성화 함수를 통과한 후에 일반적으로 구현되는 또 다른 단계는 **풀링(pooling)**이다. 풀링의 기본 아이디어는 특정 위치의 현재 출력을 주변 출력들의 요약 통계량으로 대체하는 것이다.
*   **최대 풀링 (Max pooling):** 주변 픽셀들 중 최댓값으로 대체한다. (책 그림 5-5 참고)
*   기타: 평균 풀링, 가중 평균 풀링 등.
풀링은 세부 정보를 희생하는 대신 **차원을 축소**하고 전체 이웃의 정보를 요약한다. 다음과 같은 장점이 있다:
*   입력의 작은 공간적 이동에 대한 **근사적인 불변성(approximate invariance)**을 제공한다 (특징의 정확한 위치보다 존재 여부가 중요할 때 유용).
*   네트워크의 통계적 효율성을 크게 향상시킬 수 있다.
*   다음 계층으로의 입력 수를 줄여 계산 효율성과 메모리 요구 사항을 개선한다.
*   다양한 크기의 입력을 처리하는 데 도움이 된다.

## 이미지 분류를 위한 합성곱 신경망 (CNN) [🔝](#toc) <a id="h2-8"></a>
이미지 분류와 같은 AI 작업을 수행하기 위해 CNN의 구성 요소들이 어떻게 결합되는지 살펴보자. 훈련 과정은 4장의 단계를 따른다:
1.  무작위 가중치 초기화.
2.  이미지 배치를 CNN에 순방향 전파하여 클래스 출력.
3.  특정 가중치 선택에 대한 손실 함수 평가.
4.  네트워크를 통해 오차 역전파.
5.  오차에 기여한 가중치 조정 (확률적 경사 하강법).
6.  수렴할 때까지 반복.
파이썬의 케라스(Keras) 라이브러리는 이미 훈련된 많은 모델(가중치가 고정된)을 제공하므로, 이를 특정 데이터셋에 평가해볼 수 있다. 성공적인 네트워크 아키텍처(예: LeNet1, AlexNet)를 관찰하고 학습하는 것이 중요하다. (책 그림 5-6, 5-7 참고)

## Summary
5장에서는 CNN의 핵심 구성 요소인 **합성곱 연산**을 정의했다. CNN은 컴퓨터 비전, 기계 오디오 처리 및 기타 AI 응용 분야에 필수적이다.
시스템 설계 관점에서 합성곱을 제시한 다음, 1차원 및 2차원 신호 필터링을 통해 설명했다. 합성곱 연산의 선형 대수적 등가물(특수 구조의 행렬 곱셈)을 강조하고 이미지 분류 예시로 마무리했다. 또한, CNN 아키텍처의 중요한 부분인 **풀링**과 **특징 맵**에 대해서도 다루었다.

## Epilogue
4장에서 신경망이라는 강력한 '엔진'을 배웠다면, 5장에서는 그 엔진에 '터보차저(합성곱)'와 '인터쿨러(풀링)'를 장착하여 이미지와 같은 특정 유형의 데이터 처리에 최적화된 '스포츠카(CNN)'를 만드는 법을 익혔다. 필터(커널)라는 작은 도구가 이미지 위를 슬라이딩하며 엣지, 질감 등 다양한 특징을 추출해내는 과정은 마치 우리가 세상을 인지하는 방식과 유사하여 매우 직관적이었다.
특히 합성곱이 수학적으로는 복잡해 보일 수 있지만, 선형 대수의 관점에서 보면 특정 구조를 가진 행렬 곱셈으로 표현될 수 있다는 점, 그리고 신경망이 이 행렬의 가중치를 학습한다는 사실은 이전 장들의 내용과 자연스럽게 연결되었다.
CNN은 컴퓨터 비전 분야의 혁명을 이끌었을 뿐만 아니라, 자연어 처리 등 다른 분야에서도 그 가능성을 보여주고 있다. 앞으로 이 책에서 CNN을 자주 마주치게 될 것이라고 하니, 오늘 배운 핵심 원리들을 잘 기억해 두어야겠다. 다음 장에서는 또 어떤 흥미로운 수학적 도구가 AI의 세계를 풍요롭게 하는지 기대된다.
